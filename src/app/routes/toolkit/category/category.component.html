<page-header></page-header>
<nz-card>

  <div class="mb-md">
    <button (click)="add('')" nz-button nzType="primary"><i nz-icon nzTheme="outline" nzType="plus"></i>新增</button>
    <button (click)="loadData()" nz-button nzType="primary">刷新</button>
  </div>

  <nz-table #nzTable [nzData]="treeUtils?.data" nzSize="small">
    <thead>
    <tr>
      <th>名称</th>
      <th nzWidth="20%">代码</th>
      <th nzWidth="80px">系统</th>
      <th nzWidth="80px">启用</th>
      <th nzWidth="20%">操作</th>
    </tr>
    </thead>
    <tbody (cdkDropListDropped)="drop($event)"  cdkDropList>
    <ng-template [ngForOf]="nzTable.data" let-data ngFor>
      <ng-template [ngForOf]="treeUtils?.expandDataCache[data.id]" let-item ngFor>
        <tr *ngIf="(item.parent&&item.parent.expand)||!(item.parent)" cdkDrag>
          <td (nzExpandChange)="collapse(treeUtils?.expandDataCache[data.id],item,$event)"
              [(nzExpand)]="item.expand"
              [nzIndentSize]="item.level*10"
              [nzShowExpand]="!!item && (!!item.children && item.children.length>0)"
          >
            <label (ngModelChange)="checkboxChange($event,item)"
                   [(ngModel)]="item.checked"
                   [(nzChecked)]="item.checked"
                   [(nzIndeterminate)]="item.indeterminate"
                   nz-checkbox
            >
              {{item.name}}
            </label>
          </td>
          <td>{{item.code}}</td>
          <td [innerHTML]="item.system | yn"></td>
          <td [innerHTML]="item.enabled | yn"></td>
          <td>
            <a (click)="add(item.id)">
              <i nz-icon nzTheme="outline" nzType="plus"></i>子节点
            </a>
            <nz-divider nzType="vertical"></nz-divider>
            <a (click)="edit(item)">
              <i nz-icon nzTheme="outline" nzType="edit"></i>更新
            </a>
            <nz-divider nzType="vertical"></nz-divider>
            <a (click)="delete(item.id)">
              <i nz-icon nzTheme="outline" nzType="delete"></i>删除
            </a>
          </td>
        </tr>
      </ng-template>
    </ng-template>
    </tbody>
  </nz-table>

</nz-card>
