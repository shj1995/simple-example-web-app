<page-header></page-header>
<nz-card>

  <div class="mb-md">
      <button (click)="toAddNode()" nz-button nzType="primary"><i nz-icon nzTheme="outline" nzType="plus"></i>追加节点</button>
      <button (click)="toUpdateNode()" nz-button nzType="default"><i nz-icon nzType="edit" theme="outline"></i>更新节点</button>
      <button (click)="toRemoveNode()" nz-button nzType="danger"><i nz-icon nzType="delete" theme="outline"></i>删除节点</button>
      <button (click)="getCheckedNodeIdGroupByCheckState()" nz-button nzType="default"><i nz-icon nzType="search" theme="outline"></i>获取选中节点</button>
  </div>

  <nz-table #nzTable [nzData]="treeUtils?.data">
    <thead>
    <tr>
      <th>名称</th>
      <th>数量</th>
      <th>备注</th>
      <th>操作</th>
    </tr>
    </thead>
    <tbody>
    <ng-template [ngForOf]="nzTable.data" let-data ngFor>
      <ng-template [ngForOf]="treeUtils?.expandDataCache[data.key]" let-item ngFor>
        <tr *ngIf="(item.parent&&item.parent.expand)||!(item.parent)">
          <td (nzExpandChange)="collapse(treeUtils?.expandDataCache[data.key],item,$event)" [(nzExpand)]="item.expand" [nzIndentSize]="item.level*20" [nzShowExpand]="!!item && (!!item.children || item.hasChildren)">
            <label (ngModelChange)="checkboxChange($event,item)"
                   [(ngModel)]="item.checked"
                   [(nzChecked)]="item.checked"
                   [(nzIndeterminate)]="item.indeterminate"
                   nz-checkbox
            >
              {{item.name}}
            </label>
          </td>
          <td>{{item.num}}</td>
          <td>{{item.address}}</td>
          <td>
            <a (click)="openCreateForm(item)">
              <i nz-icon nzTheme="outline" nzType="plus"></i>子节点
            </a>
            <nz-divider nzType="vertical"></nz-divider>
            <a (click)="openUpdateForm(item)">
              <i nz-icon nzTheme="outline" nzType="edit"></i>更新
            </a>
            <nz-divider nzType="vertical"></nz-divider>
            <a  (click)="toRemoveNode(item)">
              <i nz-icon nzTheme="outline" nzType="delete"></i>删除
            </a>
          </td>
        </tr>
      </ng-template>
    </ng-template>
    </tbody>
  </nz-table>

</nz-card>
